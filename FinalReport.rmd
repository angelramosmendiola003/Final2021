---
title: "Covid91 vaccine study Final2021"
author: "Put your name here!"
date: "put the date here"
output: 
  html_document:
    number_sections: true
    toc: true

---

```{r include=FALSE,echo=FALSE}
require(tidyverse)
require(tigerstats)
require(forcats)
OldData <-read.csv(file="covid91.csv",header=TRUE)
#recode to remove the annoying "X" from the dataframe
FinalData <- OldData %>% mutate(infected = recode(infected, aids = "covid", none = "OK" )) %>% select(-one_of("X"))
```

# Introduction

A new  preventative vaccine (covid91) is under test in clinical trials. Given the nature of this vaccine it is suspected that the drug may exhibit different effectiveness across the variety of subpopulations tracked. Consider population subgroups consisting of Males, Females, just the drug users, and just those in the LGBTQ community. Write a complete report that separately considers this drug for each subgroup and your recommendations as to whether people in the subgroup should take the vaccine. Structure your report in four sections each devoted to one of the four subgroups, use null and alternative hypothesis statements and correct statistical verbage when referencing p-values in conclusions.

# Methods 
In order to find the drug's effectiveness on the different genders (Males and Females) and circumstances that the people are in (LGBTQ and Drug Users), I am going to be using the following methods: 

```{r}
maledata <-filter(FinalData,sex=="guy") 
maledata$sex <- as.factor(maledata$sex)  
maledata$treatment <- as.factor(maledata$sex)  

```

```{r}
femaledata <-filter(FinalData,sex=="gal") 
femaledata$sex <- as.factor(femaledata$sex) 
femaledata$treatment <- as.factor(femaledata$sex)  
```

```{r}
maledata <-filter(FinalData,sex=="guy") 
```

# Males 

## Bar Chart

```{r}
Males <- maledata %>% group_by(infected,treatment) %>% summarize(count=n()) %>% mutate(prcnt=count/sum(count))


# the group_by followed by summarize(count=n())

basicC <- ggplot(Males,aes(x=infected,y=count,fill=treatment))
basicC + geom_bar(stat="identity",position="dodge")

#Now for percentage plot

basicCC <- ggplot(Males,aes(x=infected,y=prcnt*100,fill=treatment)) 
basicCC + geom_bar(stat="identity", position = "dodge")
```

After reviewing the Bar Chart, I can estimate that the percentage of the 340 males that participated in the study who were infected with Covid-19 that got the drug was around 58.5, now the percentage of the males who were infected with Covid-19 that got the placebo was around 41.5. 

## Numerical Summary
```{r}
table1 <- xtabs(~treatment + infected, data=maledata)
rowPerc(table1)
colPerc(table1)
print(table1)
```

After reviewing this Numerical Chart, around 340 males that were in the study caught Covid-19 out of the 10,787 men tested. The table shows me that 3.72% of males who took the drug caught Covid-19 and the 2.55% of the men that got injected with the placebo caught Covid-19. The Numerical Summary shows that men are 50% more likely to catch Covid-19 after being injected with the vaccine, this shows that the vaccine is not effective. 

## Inferential Results
```{r}
chisq.test(table1)
chisqtestGC(table1)
fisher.test(table1)
```

After seeing the Inferential Results you can see that the P-Value for both the Fisher Exact Test (0.0006181) and the Chi-squared (0.0005801) are relatively small. This can tell me that the results you see on the Inferential Results are accurate and not by any coincidence.   
$H_0$ The Null Hypothesis shows that there is not a difference in men catching Covid-19 if they get vaccine or not.  
$H_A$ The Alternative Hypothesis shows that the vaccine does in fact make a difference in men catching Covid-19 if they do get the vaccine or not. So, I reject the Null Hypothesis after seeing the Alternative Hypothesis. 

```
```


# Females

## Bar Chart

```{r}
Females <- femaledata %>% group_by(infected,treatment) %>% summarize(count=n()) %>% mutate(prcnt=count/sum(count))


# the group_by followed by summarize(count=n())

basicC <- ggplot(Females,aes(x=infected,y=count,fill=treatment))
basicC + geom_bar(stat="identity",position="dodge")

#Now for percentage plot

basicCC <- ggplot(Females,aes(x=treatment,y=prcnt*100,fill=infected)) 
basicCC + geom_bar(stat="identity", position = "dodge")
```

# LGBTQ

# Drug Users 

# Discussion

# Conclusion 

